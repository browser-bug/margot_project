<margot>


  <block name="foo">

    <!-- MONITOR SECTION -->

    <monitor name="my_temperature_monitor" type="Temperature">
      <expose var_name="avg_temperature" what="average" />
    </monitor>

    <monitor name="my_throughput_monitor" type="Throughput">
      <stop>
        <param name="num_job_done">
          <local_var name="data" type="double" />
        </param>
      </stop>
      <expose var_name="avg_throughput" what="average" />
    </monitor>

    <monitor name="my_quality_monitor" type="custom">
      <spec>
        <header reference="margot/monitor.hpp" />
        <class name="margot::Monitor&lt;double&gt;" />
        <type name="double" />
        <stop_method name="push" />
      </spec>
      <stop>
        <param name="quality">
          <local_var name="quality" type="double" />
        </param>
      </stop>
      <expose var_name="avg_quality" what="average" />
    </monitor>


    <!-- SW-KNOB SECTION -->
    <knob name="num_threads" var_name="threads" var_type="int"/>
    <knob name="num_trials" var_name="trials" var_type="int"/>


    <!-- METRIC SECTION -->
    <metric name="throughput" type="float" distribution="yes"/>
    <metric name="quality" type="float" distribution="yes"/>
    <metric name="temperature" type="float" />


    <!-- RUNTIME INFORMATION PROVIDER -->
    <adapt metric_name="throughput" using="my_throughput_monitor" inertia="1" />


    <!-- GOAL SECTION -->
    <goal name="my_throughput_goal" metric_name="throughput" cFun="GT" value="25" />
    <goal name="my_quality_goal" metric_name="quality" dFun="Average" cFun="GT" value="0.6" />


    <!-- OPTIMIZATION SECTION -->
    <state name="my_optimization" starting="yes" >
      <minimize combination="simple">
        <metric name="temperature" coef="1.0"/>
      </minimize>
      <subject to="my_throughput_goal" confidence="3" priority="10" />
      <subject to="my_quality_goal" confidence="1" priority="20" />
    </state>


  </block>




</margot>
