<margot application="my_application_name" version="my_version">


  <block name="my_block_name">



    <!-- MONITOR SECTION -->

    <monitor name="my_time_monitor" type="Time">
      <creation>
        <param name="time_measure">
          <fixed value="margot::TimeUnit::MILLISECONDS"/>
        </param>
      </creation>
      <expose var_name="avg_time" what="average" />
    </monitor>

    <monitor name="my_error_monitor" type="custom">
      <spec>
        <header reference="margot/monitor.hpp" />
        <class name="margot::Monitor&lt; float &gt;" />
        <type name="float" />
        <stop_method name="push" />
      </spec>
      <stop>
        <param name="error">
          <local_var name="error" type="float" />
        </param>
      </stop>
      <expose var_name="avg_error" what="average" />
    </monitor>


    <!-- SW-KNOB SECTION -->
    <knob name="num_threads" var_name="threads" var_type="int"/>
    <knob name="skip_factor" var_name="skip" var_type="int"/>


    <!-- METRIC SECTION -->
    <metric name="time_ms" type="float" distribution="yes" />
    <metric name="error" type="float" distribution="yes" />


    <!-- FEATURE SECTION -->
    <features distance="euclidean">
      <feature name="size_x" type="int" comparison="-"/>
      <feature name="size_y" type="int" comparison="-"/>
    </features>

    <!-- LOCAL APPLICATION HANDLER -->
    <agora doe_name="strauss" number_point_per_dimension="50" number_observations_per_point="2" min_distance="0.2">
      <explore knob_name="num_threads" range="1,4,1"/>
      <explore knob_name="skip_factor" values="5,6,7"/>
      <predict metric_name="time_ms" prediction="crs" monitor="my_time_monitor"/>
      <predict metric_name="error" prediction="crs" monitor="my_error_monitor"/>
      <given feature_name="size_x" range="10,30,10"/>
      <given feature_name="size_y" values="10,20,30"/>
    </agora>

    <!-- GOAL SECTION -->
    <goal name="my_time_goal" metric_name="time_ms"  cFun="LE" value="100" />


    <!-- RUNTIME INFORMATION PROVIDER -->
    <adapt metric_name="time_ms" using="my_time_monitor" inertia="3" />


    <!-- OPTIMIZATION SECTION -->
    <state name="my_optimization_1" starting="yes" >

      <minimize combination="linear">
        <metric name="error" coef="1.0"/>
      </minimize>

      <subject to="my_time_goal" confidence="3" priority="30" />
    </state>

  </block>




</margot>
